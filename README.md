# numeri

![Node.js](https://img.shields.io/badge/Node.js-339933?style=flat&logo=nodedotjs&logoColor=white)
![TypeScript](https://img.shields.io/badge/TypeScript-3178C6?style=flat&logo=typescript&logoColor=fff)
![Express.js](https://img.shields.io/badge/Express.js-000000?style=flat&logo=express&logoColor=white)
![SQLite](https://img.shields.io/badge/SQLite-003B57?style=flat&logo=sqlite&logoColor=white)
![Redis](https://img.shields.io/badge/Redis-DC382D?style=flat&logo=redis&logoColor=white)

## What is numeri?
No overkill, no fuss, just the essentials.  

A lightweight analytics tool that lets you track events from your applications and retrieve the data later.  
Think of it as a lightweight alternative to complex analytics platforms: you send events, they get processed and stored, you query them back.

## Core functionality

**Registration**  
New clients can register via the POST `/v1/clients/register` endpoint using a code generated by an admin.  
Each client gets an API key and secret pair for authentication.

**Tracking**  
Any event can be sent with custom properties to the POST `/v1/events` endpoint and numeri will store it enriched with geolocation, referrer, visitor and timestamp.

**Processing**  
Using Redis as bus, events are processed by a separate component to ensure fast response times and reliability.

**Retrieval**  
Processed events can be queried from the GET `/v1/events` endpoint filtering, pagination, and sorting.  
Filtering is possible on any property of the event, including custom nested ones.  
e.g. `?eventType=clik&properties.some.nested.property.key=value`.  
You can also pass a `fields` parameter to only get back the root level properties you need.  
e.g. `?fields=visitorId,eventType,timestamp`.

## Local development

1. **Set up**:
   Create a `.env` file in the root directory with the following content:
   ```env
    NODE_ENV=dev
    LOG_LEVEL=debug
    REDIS_URL=your-up-and-running-redis-server-url (e.g. redis://localhost:6379)
    ADMIN_BEARER=your-admin-bearer-token
    ROOT_URL=http://localhost:3000
   ```

2. **Install and run**:  
   Before running these commands, remember to run the Redis server.
   ```bash
   nvm use
   npm install
   npm run migrate:up
   npm run dev
   ```

3. **Test the application**:
    ```bash
    curl http://localhost:3000/
    ```
   